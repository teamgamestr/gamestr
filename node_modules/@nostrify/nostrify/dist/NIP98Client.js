import { NIP98 } from "./NIP98.js";
import { N64 } from "./utils/N64.js";
class NIP98Client {
  signer;
  customFetch;
  constructor(opts) {
    this.signer = opts.signer;
    this.customFetch = opts.fetch ?? globalThis.fetch.bind(globalThis);
  }
  /** Performs a fetch request with NIP98 authentication */
  async fetch(input, init) {
    const request = new Request(input, init);
    const template = await NIP98.template(request);
    const event = await this.signer.signEvent(template);
    const token = N64.encodeEvent(event);
    request.headers.set("Authorization", `Nostr ${token}`);
    return this.customFetch(request);
  }
}
export {
  NIP98Client
};
